# –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ HTTPS
RewriteEngine On
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# –ó–∞–ø—Ä–µ—Ç –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É .env
<Files .env>
    Require all denied
</Files>

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresByType text/css "access plus 1 year"
    ExpiresByType text/javascript "access plus 1 year"
    ExpiresByType application/javascript "access plus 1 year"
    ExpiresByType image/jpeg "access plus 1 year"
    ExpiresByType image/png "access plus 1 year"
    ExpiresByType image/gif "access plus 1 year"
    ExpiresByType image/svg+xml "access plus 1 year"
    ExpiresByType image/webp "access plus 1 year"
    ExpiresByType application/font-woff2 "access plus 1 year"
    ExpiresByType application/font-woff "access plus 1 year"
    ExpiresByType application/font-ttf "access plus 1 year"
    ExpiresByType application/font-otf "access plus 1 year"
    ExpiresByType image/x-icon "access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
    # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤ –Ω–∞ 1 –≥–æ–¥
    <FilesMatch "\.(js|css|jpg|jpeg|png|gif|svg|webp|woff|woff2|ttf|otf|ico)$">
        Header set Cache-Control "max-age=31536000, public"
    </FilesMatch>

    # Content Security Policy
    Header set Content-Security-Policy "
    default-src 'self'; 
    script-src 'self' 'unsafe-inline' 'unsafe-eval' https://js.stripe.com https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/ https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://code.jquery.com https://cdnjs.cloudflare.com/ajax/libs/uuid/8.3.2/ https://connect.facebook.net https://unpkg.com; 
    frame-src 'self' https://www.google.com/recaptcha/ https://js.stripe.com https://checkout.stripe.com; 
    connect-src 'self' https://api.stripe.com https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/; 
    img-src 'self' data: https://www.gstatic.com https://www.google.com https://www.foodcasecatering.net https://www.facebook.com; 
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://code.jquery.com https://unpkg.com; 
    font-src 'self' https://fonts.gstatic.com https://cdnjs.cloudflare.com;
    img-src 'self' data: https://www.gstatic.com https://www.google.com;
    "
    
    # –†–∞–∑—Ä–µ—à–∞–µ–º –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–ª—è CORS
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, POST, OPTIONS"
    Header set Access-Control-Allow-Headers "X-Requested-With, X-CSRF-Token, Content-Type, Origin, Authorization, Accept"

    # –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ CORS –¥–ª—è —à—Ä–∏—Ñ—Ç–æ–≤
    <FilesMatch "\.(ttf|ttc|otf|eot|woff|woff2|svg)$">
        Header set Access-Control-Allow-Origin "*"
        Header set Access-Control-Allow-Headers "Range"
        Header set Access-Control-Expose-Headers "Accept-Ranges, Content-Encoding, Content-Length, Content-Range"
    </FilesMatch>
</IfModule>

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ MIME-—Ç–∏–ø–∞ –¥–ª—è TTF, OTF –∏ favicon (.ico) —Ñ–∞–π–ª–æ–≤
<IfModule mod_mime.c>
    AddType application/font-ttf .ttf
    AddType application/font-otf .otf
    AddType image/x-icon .ico
</IfModule>

# üî• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
RewriteRule ^auth/login$ users/login.php [L]
RewriteRule ^auth/register$ users/register.php [L]
RewriteRule ^auth/logout$ users/logout.php [L]
RewriteRule ^dashboard$ users/dashboard.php [L]
RewriteRule ^orders/([0-9]+)$ users/order_details.php?order_id=$1 [L]
RewriteRule ^orders/repeat$ users/repeat_order.php [L]
RewriteRule ^orders/cancel$ users/cancel_order.php [L]
RewriteRule ^orders/history$ users/order_history.php [L]
RewriteRule ^orders/history$ users/orders.php [L]

# –í–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—à–∏–±–æ–∫ PHP (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
php_flag display_errors on
php_flag display_startup_errors on
php_value error_reporting -1

# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –æ–∂–∏–¥–∞–Ω–∏—è
Timeout 600
KeepAlive On
MaxKeepAliveRequests 100
KeepAliveTimeout 5
