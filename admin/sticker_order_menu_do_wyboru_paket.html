<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/assets/stylescss/styles_paket.css">
  <title>Etykiety Menu do Wyboru na Opakowania</title>
</head>
<body>
  <div class="container" id="sticker-container">
    <!-- –ó–¥–µ—Å—å –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∏–∫–µ—Ä—ã -->
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function () {
        const packageStickerDataJSON = localStorage.getItem('packageStickerData');
        if (!packageStickerDataJSON) {
            alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–∫–ª–µ–µ–∫.');
            console.error('packageStickerData –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ localStorage');
            window.location.href = "/admin/orders_summary.php";
            return;
        }

        let packageStickerData = JSON.parse(packageStickerDataJSON);
        console.log("üì¶ –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage:", JSON.stringify(packageStickerData, null, 2));

        if (!packageStickerData.packages || packageStickerData.packages.length === 0) {
            alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–∞–∫–ª–µ–µ–∫.');
            console.error('packageStickerData.packages –ø—É—Å—Ç');
            window.location.href = "/admin/orders_summary.php";
            return;
        }

        const container = document.getElementById('sticker-container');
        container.innerHTML = ""; // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–µ—Ä–µ–¥ –≤—Å—Ç–∞–≤–∫–æ–π

        packageStickerData.packages.forEach((packageInfo) => {
            const stickerElement = document.createElement('div');
            stickerElement.classList.add('sticker-paket');

            const address = packageInfo.address || "–ù–µ —É–∫–∞–∑–∞–Ω –∞–¥—Ä–µ—Å";
            const houseNumber = packageInfo.houseNumber || "";
            const apartment = packageInfo.apartment || "";
            const fullAddress = `${address} ${houseNumber} / ${apartment}`.trim();

            console.log(`üñ® –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–∫–ª–µ–π–∫—É –¥–ª—è –∞–¥—Ä–µ—Å–∞: ${fullAddress}`);

            stickerElement.innerHTML = `
              <div class="sticker-paket-header">
                <h1 class="title-text">Menu: Menu do Wyboru</h1>
                <img class="logo-image" src="/assets/img/sticker_container.png" alt="Logo" />
              </div>
              <div class="sticker-paket-info">
                <div class="info-block">
                  <span class="info-label">Adres:</span>
                  <span class="info-value">${fullAddress}</span>
                </div>
                <div class="info-block">
                  <span class="info-label">Data:</span>
                  <span class="info-value">${packageStickerData.delivery_date}</span>
                </div>
              </div>
            `;

            container.appendChild(stickerElement);
        });

        console.log(`‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –°–æ–∑–¥–∞–Ω–æ ${packageStickerData.packages.length} –Ω–∞–∫–ª–µ–µ–∫.`);
    });
  </script>
</body>
</html>
